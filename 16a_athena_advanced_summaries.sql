CREATE EXTERNAL TABLE IF NOT EXISTS thera_gold.gold_advanced_summaries (
    company_key string,
    domain string,
    company_name string,
    executive_summary string,
    executive_summary_hash string,
    executive_summary_confidence double,
    key_insights array<string>,
    key_insights_hash string,
    business_model string,
    value_proposition string,
    target_customers array<string>,
    revenue_model string,
    primary_technologies array<string>,
    programming_languages array<string>,
    frameworks array<string>,
    databases array<string>,
    cloud_providers array<string>,
    dev_tools array<string>,
    tech_maturity_score double,
    innovation_level string,
    tech_stack_hash string,
    market_position string,
    competitive_advantages array<string>,
    differentiators array<string>,
    market_share_estimate string,
    competitive_threats array<string>,
    moat_strength string,
    competitive_analysis_hash string,
    business_risks array<string>,
    technical_risks array<string>,
    market_risks array<string>,
    financial_risks array<string>,
    regulatory_risks array<string>,
    overall_risk_level string,
    risk_score double,
    red_flags array<string>,
    risk_assessment_hash string,
    market_opportunity string,
    growth_potential string,
    scalability_indicators array<string>,
    market_timing string,
    industry_trends array<string>,
    market_dynamics array<string>,
    business_intelligence_hash string,
    investment_readiness string,
    funding_recommendation string,
    valuation_indicators array<string>,
    due_diligence_notes array<string>,
    exit_potential string,
    investment_timeline string,
    investment_analysis_hash string,
    target_market_size string,
    market_segments array<string>,
    geographic_focus array<string>,
    customer_personas array<string>,
    market_barriers array<string>,
    market_opportunities array<string>,
    market_analysis_hash string,
    growth_indicators array<string>,
    innovation_indicators array<string>,
    traction_indicators array<string>,
    scalability_indicators array<string>,
    summary_quality_score double,
    data_completeness_score double,
    confidence_level string,
    validation_status string,
    llm_model_used string,
    processing_cost_usd double,
    processing_time_ms int,
    tokens_used int,
    batch_id string,
    content_hash string,
    last_content_update timestamp,
    summary_generation_method string,
    source_systems array<string>,
    created_at timestamp,
    updated_at timestamp,
    last_verified_at timestamp,
    dt string
)
PARTITIONED BY (dt)
STORED AS PARQUET
LOCATION 's3://thera-curated-805595753342-v3/gold/advanced_summaries/'
TBLPROPERTIES (
    'parquet.compression' = 'SNAPPY',
    'classification' = 'gold',
    'data_quality' = 'llm_enhanced'
);
